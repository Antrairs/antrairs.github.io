var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,c=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&o(e,r,t[r]);if(s)for(var r of s(t))n.call(t,r)&&o(e,r,t[r]);return e},l=(e,s)=>t(e,r(s)),i=(e,t,r)=>new Promise(((s,a)=>{var n=e=>{try{c(r.next(e))}catch(t){a(t)}},o=e=>{try{c(r.throw(e))}catch(t){a(t)}},c=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);c((r=r.apply(e,t)).next())}));import{f as d,g as u,l as h,V as m,T as p,L as f,C as b,m as g,I as x,B as j,o as y}from"./vendors.8d5e5efc.js";function v(){const[e,t]=d.useState(""),[r,s]=d.useState([{role:"assistant",content:"\u6b22\u8fce\u4f7f\u7528\u7532\u9aa8\u667a\u97f5\uff01\u6211\u662f\u60a8\u4e13\u5c5e\u7684\u7532\u9aa8\u6587\u5b66\u4e60\u5411\u5bfc\u4e0e\u591a\u6a21\u6001\u63a2\u7d22\u52a9\u624b\u3002\u60f3\u8bc6\u7532\u9aa8\u3001\u89e3\u5b57\u6e90\u3001\u63a2\u6bb7\u5546\uff1f\u6ca1\u95ee\u9898\uff01\u65e0\u8bba\u662f\u6587\u5b57\u89e3\u8bfb\u3001\u6c89\u6d78\u5f0f\u4f53\u9a8c\uff0c\u8fd8\u662f\u968f\u65f6\u968f\u5730\u7684\u667a\u80fd\u95ee\u7b54\uff0c\u6211\u90fd\u80fd\u6ee1\u8db3\u60a8\u7684\u6c42\u77e5\u6b32\u3002\u8ba9\u6211\u4eec\u643a\u624b\uff0c\u4ee5\u73b0\u4ee3\u79d1\u6280\u89e3\u9501\u53e4\u8001\u667a\u6167\u5427\uff01\u73b0\u5728\uff0c\u6709\u4ec0\u4e48\u6211\u53ef\u4ee5\u5e2e\u60a8\u63a2\u7d22\u7684\u5417\uff1f"}]),[a,n]=d.useState(!1),o=d.useRef(null),v=d.useRef(null);u((()=>{console.log("AI QA Interaction Page loaded.")}));const w=e=>{t(e.target.value)},O=()=>{var e;null==(e=v.current)||e.scrollIntoView({behavior:"smooth"})};d.useEffect((()=>{O()}),[r]);const N=()=>i(this,null,(function*(){if(!e.trim())return void y.warning("\u8bf7\u8f93\u5165\u5185\u5bb9\uff01");const a={role:"user",content:e};s((e=>[...e,a])),t(""),n(!0),o.current=new AbortController;const i=o.current.signal;try{const t=yield fetch("https://llm.chutes.ai/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer cpk_0b45ae9eb7a14cb693a8c975a4afe68c.187ffd27e61b5110960fa15885549cf5.tcsxlORoGZR1BrWeLDJdJ5Ji2rzswbvv","Content-Type":"application/json"},body:JSON.stringify({model:"deepseek-ai/DeepSeek-V3-0324",messages:[...r,{role:"user",content:e}],stream:!0,max_tokens:1024,temperature:.7}),signal:i});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const a=t.body.getReader(),n=new TextDecoder("utf-8");let o="";while(1){const{done:e,value:t}=yield a.read();if(e)break;o+=n.decode(t,{stream:!0});const r=o.split("\n");o=r.pop();for(const a of r)if(a.startsWith("data: "))try{const e=JSON.parse(a.substring(6));e.choices&&e.choices[0]&&e.choices[0].delta&&e.choices[0].delta.content&&s((t=>{const r=t[t.length-1];return r&&"assistant"===r.role?t.map(((r,s)=>s===t.length-1?l(c({},r),{content:r.content+e.choices[0].delta.content}):r)):[...t,{role:"assistant",content:e.choices[0].delta.content}]}))}catch(d){console.error("Error parsing JSON:",d,"Line:",a)}}}catch(u){"AbortError"===u.name?console.log("Fetch aborted"):(console.error("Fetch error:",u),s((e=>[...e,{role:"assistant",content:`Error: ${u.message}`}])))}finally{n(!1),o.current=null}})),P=()=>{o.current&&o.current.abort()};return h.jsxs(m,{className:"ai-qa-interaction",children:[h.jsx(p,{className:"title",children:"AI \u95ee\u7b54\u4e92\u52a8"}),h.jsxs(m,{className:"message-list-container",children:[h.jsx(f,{dataSource:r,renderItem:(e,t)=>h.jsx(f.Item,{className:`message-item-container ${e.role}`,children:h.jsx(b,{className:`message-card ${e.role}`,children:h.jsx(p,{className:"message-content",children:e.content})})},t)}),a&&h.jsx(m,{className:"loading-indicator",children:h.jsx(g,{size:"large"})}),h.jsx(m,{ref:v})]}),h.jsxs(m,{className:"input-area",children:[h.jsx(x.TextArea,{value:e,onChange:w,onPressEnter:e=>{e.shiftKey||(e.preventDefault(),N())},placeholder:"\u8bf7\u8f93\u5165\u60a8\u7684\u95ee\u9898...",autoSize:{minRows:1,maxRows:4},className:"input-text-area"}),h.jsxs(m,{className:"button-group",children:[h.jsx(j,{type:"primary",onClick:N,loading:a,disabled:a||!e.trim(),children:"\u53d1\u9001"}),h.jsx(j,{onClick:P,disabled:!a,children:"\u53d6\u6d88"})]})]})]})}export{v as default};
